<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Ethereum Voting DApp</title>
    <!-- Include Bootstrap (optional) -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    />
    
    <!-- 1) Include jQuery BEFORE app.js -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.2.11/dist/web3.min.js"></script>

    <!-- Truffle Contract JS -->
    <script src="https://cdn.jsdelivr.net/npm/truffle-contract@3.0.6/dist/truffle-contract.min.js"></script>

    <!-- 2) Then load your bundled JavaScript -->
    <script src="build/app.js"></script>
  </head>
  <body class="p-4">
    <h1 class="mb-4">Ethereum Voting DApp</h1>
    

    <!-- Section: Voter Registration -->
    <section id="registration-section" class="mb-4">
      <h2>Voter Registration</h2>
      <p>Click the button below to register as a voter on the blockchain.</p>
      <button id="registerBtn" class="btn btn-primary">Register as Voter</button>
    </section>

    <!-- Section: Vote Delegation -->
    <section id="delegation-section" class="mb-4">
      <h2>Vote Delegation</h2>
      <p>Enter the address of the person you want to delegate your vote to, then click Delegate.</p>
      <div class="row g-2">
        <div class="col-auto">
          <input type="text" id="delegateAddress" class="form-control" placeholder="0x123..." />
        </div>
        <div class="col-auto">
          <button id="delegateBtn" class="btn btn-primary">Delegate Vote</button>
        </div>
      </div>
    </section>

    <!-- Section: Voting -->
    <section id="voting-section" class="mb-4">
      <h2>Voting</h2>
      <p>Enter your user ID and select a candidate, then click Vote.</p>
      <div class="mb-2">
        <input type="text" id="id-input" class="form-control w-25" placeholder="Enter your ID" />
      </div>
      <div id="candidate-box" class="mb-3">
        <!-- Candidate checkboxes inserted by app.js -->
      </div>
      <button class="btn btn-primary" id="voteBtn">Vote</button>
    </section>

    <!-- Section: Count Votes -->
    <section id="results-section" class="mb-4">
      <h2>Check Results</h2>
      <p>Click the button below to see how many votes each candidate has.</p>
      <button class="btn btn-primary" id="countVotesBtn">Count Votes</button>
      <div id="vote-box" class="mt-3">
        <!-- Candidate vote totals inserted by app.js -->
      </div>
    </section>

    <!-- Message Display -->
    <div id="msg" class="mt-4 text-danger"></div>

    <!-- Hook up buttons to JS -->
    <script>
      $(document).ready(function () {
        // Ensure the App object is initialized before binding events
        if (typeof App !== 'undefined') {
          $('#registerBtn').click(function () {
            App.registerVoter();
          });

          $('#delegateBtn').click(function () {
            App.delegateVote();
          });

          $('#voteBtn').click(function () {
            App.vote();
          });

          $('#countVotesBtn').click(function () {
            App.findNumOfVotes();
          });
        } else {
          console.error("App object not initialized.");
        }
      });
    </script>
  </body>
</html>
